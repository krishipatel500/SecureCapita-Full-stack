<div class="page">

  <header class="navbar">
    <div class="logo" (click)="goToDashboard()">
      <span class="logo-icon">SC</span>
      <span class="logo-text">SecureCapita</span>
    </div>
  </header>

  <div class="card">
    <h2>Create Invoice</h2>

    <form [formGroup]="invoiceForm" (ngSubmit)="saveInvoice()">

      <div class="grid">

        <!-- Customer Dropdown -->
        <div>
          <label>Customer</label>
          <select formControlName="customerId">
            <option value="">Select Customer</option>
            <option *ngFor="let c of customers" [value]="c.id">
              {{ c.name }}
            </option>
          </select>
        </div>

        <div>
          <label>Invoice Date</label>
          <input type="date" formControlName="invoiceDate" />
        </div>

        <div>
          <label>Status</label>
          <select formControlName="status">
            <option value="UNPAID">UNPAID</option>
            <option value="PAID">PAID</option>
            <option value="OVERDUE">OVERDUE</option>
          </select>
        </div>

      </div>

      <h3>Services</h3>

      <div formArrayName="services">
        <div class="service-row"
             *ngFor="let s of services.controls; let i = index"
             [formGroupName]="i">

          <input placeholder="Service Name" formControlName="service" />
          <input type="number" placeholder="Rate" formControlName="rate" />
          <input type="number" placeholder="Qty" formControlName="quantity" />

          <button type="button" class="remove-btn"
                  (click)="removeService(i)"
                  *ngIf="services.length > 1">
            ✕
          </button>

        </div>
      </div>

      <button type="button" class="add-btn" (click)="addService()">
        + Add Service
      </button>

      <div class="total">
        Total: ₹ {{ getTotal() }}
      </div>

      <button class="save-btn" type="submit">
        Save Invoice
      </button>

    </form>
  </div>
</div>
